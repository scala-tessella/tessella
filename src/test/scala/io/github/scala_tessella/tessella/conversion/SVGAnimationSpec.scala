package io.github.scala_tessella.tessella
package conversion

import SVG.*
import Outliers.sqr3x3Growth

import org.scalatest.*
import org.scalatest.flatspec.*
import org.scalatest.matchers.*

class SVGAnimationSpec extends AnyFlatSpec with Helper with should.Matchers {

  "A tiling" can "be converted to an animation showing the nodes growth" in {
    prettyPrinter.format(
      sqr3x3Growth.toSVG(
        labelledNodes = LabelledNodes.NONE,
        showGrowth = true
      )
    ) shouldBe
      """<svg xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="-75.0 -75.0 200.0 200.0" xmlns="http://www.w3.org/2000/svg">
        |  <g>
        |    <title>Tiling</title>
        |    <desc>Finite tessellation of regular polygons</desc>
        |    <g style="stroke:black">
        |      <title>Edges</title>
        |      <desc>Sides of the regular polygons</desc>
        |      <line x1="0.0" y1="0.0" x2="50.0" y2="0.0"/>
        |      <line x1="50.0" y1="0.0" x2="50.0" y2="50.0"/>
        |      <line x1="50.0" y1="50.0" x2="0.0" y2="50.0"/>
        |      <line x1="0.0" y1="0.0" x2="0.0" y2="50.0"/>
        |      <line x1="0.0" y1="50.0" x2="-50.0" y2="50.0"/>
        |      <line x1="-50.0" y1="50.0" x2="-50.0" y2="0.0"/>
        |      <line x1="0.0" y1="0.0" x2="-50.0" y2="0.0"/>
        |      <line x1="-50.0" y1="0.0" x2="-50.0" y2="-50.0"/>
        |      <line x1="-50.0" y1="-50.0" x2="0.0" y2="-50.0"/>
        |      <line x1="0.0" y1="0.0" x2="0.0" y2="-50.0"/>
        |      <line x1="0.0" y1="-50.0" x2="50.0" y2="-50.0"/>
        |      <line x1="50.0" y1="0.0" x2="50.0" y2="-50.0"/>
        |      <line x1="50.0" y1="-50.0" x2="100.0" y2="-50.0"/>
        |      <line x1="100.0" y1="-50.0" x2="100.0" y2="0.0"/>
        |      <line x1="50.0" y1="0.0" x2="100.0" y2="0.0"/>
        |      <line x1="100.0" y1="0.0" x2="100.0" y2="50.0"/>
        |      <line x1="50.0" y1="50.0" x2="100.0" y2="50.0"/>
        |      <line x1="100.0" y1="50.0" x2="100.0" y2="100.0"/>
        |      <line x1="100.0" y1="100.0" x2="50.0" y2="100.0"/>
        |      <line x1="50.0" y1="50.0" x2="50.0" y2="100.0"/>
        |      <line x1="50.0" y1="100.0" x2="0.0" y2="100.0"/>
        |      <line x1="0.0" y1="50.0" x2="0.0" y2="100.0"/>
        |      <line x1="0.0" y1="100.0" x2="-50.0" y2="100.0"/>
        |      <line x1="-50.0" y1="50.0" x2="-50.0" y2="100.0"/>
        |    </g>
        |    <polygon style="fill:none;stroke:blue;stroke-width:2" points="-50.0,50.0 -50.0,100.0 0.0,100.0 50.0,100.0 100.0,100.0 100.0,50.0 100.0,0.0 100.0,-50.0 50.0,-50.0 0.0,-50.0 -50.0,-50.0 -50.0,0.0"/>
        |    <g>
        |      <polyline style="stroke:red;stroke-width:1.5;stroke-dasharray:5,5;fill:none" points="0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0 100.0,0.0 100.0,50.0 100.0,100.0 50.0,100.0 0.0,100.0 -50.0,100.0">
        |        <animate attributeName="points" dur="5s" from="0.0,0.0" to="0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0 100.0,0.0 100.0,50.0 100.0,100.0 50.0,100.0 0.0,100.0 -50.0,100.0" values="0.0,0.0 50.0,0.0;0.0,0.0 50.0,0.0 50.0,50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0 100.0,0.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0 100.0,0.0 100.0,50.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0 100.0,0.0 100.0,50.0 100.0,100.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0 100.0,0.0 100.0,50.0 100.0,100.0 50.0,100.0;0.0,0.0 50.0,0.0 50.0,50.0 0.0,50.0 -50.0,50.0 -50.0,0.0 -50.0,-50.0 0.0,-50.0 50.0,-50.0 100.0,-50.0 100.0,0.0 100.0,50.0 100.0,100.0 50.0,100.0 0.0,100.0"/>
        |      </polyline>
        |      <polygon style="stroke:red;stroke-width:1.5;fill:red" points="-50.0,100.0 -45.612087,102.397128 -45.612087,97.602872">
        |        <animate attributeName="points" dur="5s" from="0.0,0.0 4.387913,2.397128 4.387913,-2.397128" to="-50.0,100.0 -45.612087,102.397128 -45.612087,97.602872" values="50.0,0.0 45.612087,-2.397128 45.612087,2.397128;50.0,50.0 52.397128,45.612087 47.602872,45.612087;0.0,50.0 4.387913,52.397128 4.387913,47.602872;-50.0,50.0 -45.612087,52.397128 -45.612087,47.602872;-50.0,0.0 -52.397128,4.387913 -47.602872,4.387913;-50.0,-50.0 -52.397128,-45.612087 -47.602872,-45.612087;0.0,-50.0 -4.387913,-52.397128 -4.387913,-47.602872;50.0,-50.0 45.612087,-52.397128 45.612087,-47.602872;100.0,-50.0 95.612087,-52.397128 95.612087,-47.602872;100.0,0.0 102.397128,-4.387913 97.602872,-4.387913;100.0,50.0 102.397128,45.612087 97.602872,45.612087;100.0,100.0 102.397128,95.612087 97.602872,95.612087;50.0,100.0 54.387913,102.397128 54.387913,97.602872;0.0,100.0 4.387913,102.397128 4.387913,97.602872"/>
        |      </polygon>
        |    </g>
        |  </g>
        |  <metadata>
        |    <rdf:RDF>
        |      <cc:Work>
        |        <dc:source rdf:resource="https://github.com/scala-tessella/tessella">Tessella</dc:source>
        |        <cc:license rdf:resource="https://www.apache.org/licenses/LICENSE-2.0"/>
        |      </cc:Work>
        |    </rdf:RDF>
        |  </metadata>
        |</svg>""".stripMargin
  }

}
